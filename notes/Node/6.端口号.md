**命令行中输入`ipconfig`**

`IPv4` 地址：192.168.150.74 就是当前电脑连入的局域网的地址。

在搭建服务器时，我们通过`http://127.0.0.1:3000/`进行访问。现在将其改成`http://192.168.150.74:3000/`也可以访问到。同一局域网下的所有电脑设备都可访问到。

- `127.0.0.1:3000/`访问到自己的本机 
- `192.168.150.74:3000/`是局域网`IP`地址，就能够访问到开启服务器的那台电脑 



**192.168.150.74**

```
IP地址对应目标计算机;
```

**:3000**

```
端口号对应目标计算机上的应用程序。此处的应用程序是node开启的服务。
```



目标计算机给请求访问的电脑发送响应数据。

因为双方都有端口号，本地客户端浏览器与服务器上`node`开启的`web`服务器进行通信，本地客户端知道服务器的端口号，但是服务器并不知道客户端的端口号。那么服务器是怎样通过网络发给客户端响应的呢？

其实，客户端也开启了一个端口号与服务器进行通信。

**验证：**

在请求对象中，可以获取到客户端发起请求的端口号。`Response`会自己去找发起请求的客户端对应的端口号：

```javascript
server.on('request',function(req,res) {	
	console.log('请求我的客户端端口号是:', req.socket.remotePort); 
	console.log('请求我的客户端的地址是:', req.socket.remoteAddress);
})
```

**总结：**

- `ip`地址用来定位目标计算机
- 端口号用来定位具体的应用程序 
- 所有需要联网通信的应用程序都会占用端口号，我们平时注意不到是因为软件 / 浏览器已经自动帮我们做了这个事情 
- 端口号的范围：`0 - 65536`之间 
- 计算机中默认的端口号最好不要去用：例如`http`服务的 80 
- 开发过程中，使用一些简单好记的`3000`，`5000`等即可
- 可以同时开启多个服务，但一定要确保不同服务所占用的端口号不一致才行 
- 一台计算机，同一端口号同一时间只能被一个程序所占用 

```javascript
var http = require('http');
var server = http.createServer();
server.on('request', function(req, res) {
    
    // 关于内容格式编码问题:
		// 1.在服务端默认发送的数据是`utf-8`编码的内容;
		// 2.浏览器在不知道服务器响应内容的编码情况下,会按照当前操作系统的默认编码去解析;
		// 3.中文操作系统默认是`gbk`;
	// res.end('hello 世界'); 中文部分乱码
    
--------------------------------------------------------------------------------
	// 解决方法:
		// 1.告诉浏览器我给你发送的内容是什么编码的;
		// 2.在`http`协议中,`Content-Type`就是用来告知对方我给你发送的数据内容是什么类型的;
		// 3.若发送的数据是文本类型,应该采用`utf-8`来进行解析;
	res.setHeader('Content-Type','text/plain;charset=utf-8')
	res.end('hello 世界');

--------------------------------------------------------------------------------
	// 关于解析的文本拓展
	var url = req.url;
	if(url === '/plain') {
		// text/plain 就是普通文本
		res.setHeader('Content-Type','text/plain;charset=utf-8')
		res.end('hello 世界');
	}else if(url === '/html') {
		// 如果你发送的是`html`格式的字符串,也要告诉浏览器我给你发送的是`text/html`格式的内容
		res.setHeader('Content-Type','text/html;charset=utf-8')
		res.end('<p>hello html<a href="#">点我</a></p>');
	}
})

server.listen(3000, function() {
	console.log('Server is running...');
})
```



#### 结合`fs`，发送文件中的数据。

不同的资源所对应的`Content-Type`是不一样的，详情请见：

http://tool.oschina.net/commons

**注意**：一般只为字符数据指定编码，图片是不需要指定编码的。

除了`Content-Type`可以用来指定编码，在`html`页面中通过`meta`元数据来声明当前文本的编码格式，浏览器也会识别。

```html
<meta charset="UTF-8">
```

```javascript
var http = require('http');
var fs = require('fs');
var server = http.createServer();

server.on('request', function(req, res) {
	var url = req.url;
	
	if(url === '/') {
		// 当匹配 / 的时候,使用相对路径,展示index.html里面的内容
		fs.readFile('./index.html', function(err, data) { 
            // 开始匹配html代码
			if(err) {
				res.setHeader('Content-Type','text/plain; charset=utf-8')
				res.end('文件读取失败,请稍后重试!')
			}else {
				// data默认是二进制数据,可通过`.toString`转为我们能够识别的字符串;
				// res.end() 支持两种数据类型: 二进制和字符串;
				res.setHeader('Content-Type', 'text/html; charset=utf-8')
				res.end(data);
			}
		}) 
	}else if(url === '/sxw') { 
        // 匹配图片,`url`统一资源定位符,充当标识
        // 一个url对应一个资源
        fs.readFile('./iu.jpg', function(err, data) {
            if(err) {
                res.setHeader('Content-Type', 'text/plain; charset=utf-8')
                res.end('文件读取失败,请稍后重试!')
            }else {
                // 图片就不需要指定编码了
                res.setHeader('Content-Type','image/jpeg')
                res.end(data)
            }
        })
    }
})

server.listen(3000, function() {
	console.log('Server is running...')
})
```

![端口号和IP地址](C:\Users\lenovo\Desktop\2019年11月19日始\notes\Node\img\端口号和IP地址.png)



#### `JavaScript`代码风格

- `JavaScript Standard Style`	https://standardjs.com/ 

- `Airbnb JavaScript Style`



**注意**：

当采用无分号的代码风格时，需要注意以下三种情况：

- （
-   [
- ` 模板字符串，支持换行，拼接方便，所写即所得

如果一行代码以上述三种形式开头，则在开头处添加逗号用以避免语法解析错误 。

